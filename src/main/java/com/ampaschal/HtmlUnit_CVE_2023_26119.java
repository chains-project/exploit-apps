package com.ampaschal;

import com.gargoylesoftware.htmlunit.UnexpectedPage;
import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.HtmlPage;

public class HtmlUnit_CVE_2023_26119 {

    public  static  void  main (String[] args)  throws Exception {
        // This was originally supposed to be exploited using an xml file. Maybe that is a better way. But it would not have bytecode executions. 
        System.out.println("Recreating CVE-2023-26119");

        try ( final  WebClient  webClient  =  new  WebClient ()) {

            webClient.getOptions().setJavaScriptEnabled(false);

            // The original line
            // final  HtmlPage  page = webClient.getPage( "http://0.0.0.0:7000/htmlunit.html" );

            UnexpectedPage page = webClient.getPage("http://0.0.0.0:8000//xExportObject.class");

            String pageContent = page.getWebResponse().getContentAsString();
            System.out.println(pageContent);
        }
    }
}
